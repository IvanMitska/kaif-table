generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int           @id @default(autoincrement())
  email        String        @unique
  password     String
  name         String
  role         Role          @default(ACCOUNTANT)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  transactions Transaction[]
}

model Category {
  id           Int           @id @default(autoincrement())
  name         String        @unique
  type         CategoryType  @default(EXPENSE)
  color        String?
  createdAt    DateTime      @default(now())
  transactions Transaction[]
}

model PaymentMethod {
  id           Int           @id @default(autoincrement())
  name         String        @unique
  createdAt    DateTime      @default(now())
  transactions Transaction[]
}

model Transaction {
  id              Int           @id @default(autoincrement())
  date            DateTime
  amount          Float
  service         String
  supplier        String?
  comment         String?
  hasReceipt      Boolean       @default(false)
  enteredInIiko   Boolean       @default(false)

  categoryId      Int
  category        Category      @relation(fields: [categoryId], references: [id])

  paymentMethodId Int
  paymentMethod   PaymentMethod @relation(fields: [paymentMethodId], references: [id])

  userId          Int
  user            User          @relation(fields: [userId], references: [id])

  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
}

enum Role {
  ADMIN
  ACCOUNTANT
  MANAGER
}

enum CategoryType {
  INCOME
  EXPENSE
}
